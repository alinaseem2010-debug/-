<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</title>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background: linear-gradient(135deg, #74ebd5, #ACB6E5);
    color: #333;
    text-align: center;
    padding: 30px;
  }
  h1 { color: #fff; text-shadow: 2px 2px 5px #000; }
  input[type="number"], input[type="file"] {
    width: 100px; padding: 10px; margin: 8px;
    border-radius: 8px; border: 2px solid #fff; font-size: 16px; outline: none;
  }
  input[type="number"]:focus { border-color: #ff9800; }
  button {
    padding: 12px 25px; font-size: 16px; border: none;
    border-radius: 10px; cursor: pointer; background-color: #ff9800;
    color: #fff; margin-top: 10px; transition: background 0.3s;
  }
  button:hover { background-color: #e68900; }
  .result {
    margin-top: 30px; font-size: 24px; font-weight: bold;
    color: #fff; text-shadow: 1px 1px 3px #000;
  }
  hr { margin: 30px 0; border: 1px solid #fff; }
</style>
</head>
<body>

<h1>ğŸ“Š Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h1>
<p>Ø£Ø¯Ø®Ù„ Ø§Ù„Ù‚ÙŠÙ… ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ø£Ùˆ Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…:</p>

<!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙŠØ¯ÙˆÙŠÙ‹Ø§ -->
<div>
  <input type="number" id="awal" placeholder="Ø£ÙˆÙ„" oninput="calculateTrend()">
  <input type="number" id="q1" placeholder="Ø±Ø¨Ø¹1" oninput="calculateTrend()">
  <input type="number" id="mid" placeholder="Ù†ØµÙ" oninput="calculateTrend()">
  <input type="number" id="q3" placeholder="Ø±Ø¨Ø¹3" oninput="calculateTrend()">
  <input type="number" id="akhir" placeholder="Ø¢Ø®Ø±" oninput="calculateTrend()">
  <br>
  <button onclick="calculateTrend()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø§ØªØ¬Ø§Ù‡</button>
</div>

<hr>

<!-- Ø±ÙØ¹ ØµÙˆØ±Ø© -->
<div>
  <input type="file" id="imageInput" accept="image/*">
  <button onclick="readImage()">ğŸ“· Ù‚Ø±Ø§Ø¡Ø© Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©</button>
</div>

<div class="result" id="result"></div>

<script>
function calculateTrend() {
    let fields = ['awal','q1','mid','q3','akhir'];
    let values = fields.map(id => parseFloat(document.getElementById(id).value));

    if(values.every(v => isNaN(v))) return;

    // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ§Ø±ØºØ© Ø¨Ø§Ù„Ù…ØªÙˆØ³Ø·
    let validValues = values.filter(v => !isNaN(v));
    let avgValid = validValues.reduce((a,b)=>a+b,0)/validValues.length;
    values = values.map(v => isNaN(v) ? avgValid : v);
    let [awal,q1,mid,q3,akhir] = values;

    // Ø·Ø±Ù‚ ØªØ­Ù‚Ù‚ Ù…Ø¨Ø³Ø·Ø©
    let checks = [];
    checks.push(akhir > awal ? 'ØµØ¹ÙˆØ¯' : (akhir < awal ? 'Ù†Ø²ÙˆÙ„' : 'Ù…Ø­Ø§ÙŠØ¯'));
    let maxVal = Math.max(...values);
    checks.push((akhir < maxVal*0.7) ? 'Ù…ØªØ·Ø±Ù' : 'Ù…Ø­Ø§ÙŠØ¯');
    let minVal = Math.min(...values);
    checks.push((akhir > minVal*1.3) ? 'Ù…ØªØ·Ø±Ù' : 'Ù…Ø­Ø§ÙŠØ¯');
    let avg = values.reduce((a,b)=>a+b,0)/values.length;
    checks.push(akhir > avg ? 'ØµØ¹ÙˆØ¯' : 'Ù†Ø²ÙˆÙ„');

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ø¹ Ø£ÙˆÙ„ÙˆÙŠØ©
    let counts = { 'ØµØ¹ÙˆØ¯':0, 'Ù†Ø²ÙˆÙ„':0, 'Ù…Ø­Ø§ÙŠØ¯':0, 'Ù…ØªØ·Ø±Ù':0 };
    checks.forEach(c => counts[c]++);
    let finalTrend;
    if(counts['Ù…ØªØ·Ø±Ù'] > 0) finalTrend = 'Ù…ØªØ·Ø±Ù';
    else if(counts['ØµØ¹ÙˆØ¯'] > counts['Ù†Ø²ÙˆÙ„']) finalTrend = 'ØµØ¹ÙˆØ¯';
    else if(counts['Ù†Ø²ÙˆÙ„'] > counts['ØµØ¹ÙˆØ¯']) finalTrend = 'Ù†Ø²ÙˆÙ„';
    else finalTrend = 'Ù…Ø­Ø§ÙŠØ¯';

    let emoji = {'ØµØ¹ÙˆØ¯':'ğŸ“ˆ','Ù†Ø²ÙˆÙ„':'ğŸ“‰','Ù…Ø­Ø§ÙŠØ¯':'âšª','Ù…ØªØ·Ø±Ù':'âš¡'};
    document.getElementById('result').innerHTML = `ğŸ“Š Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${finalTrend} ${emoji[finalTrend]}`;
}

// Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚ÙŠÙ… Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… OCR
function readImage() {
    const input = document.getElementById('imageInput');
    if(input.files.length===0) { alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ù‹Ø§!"); return; }
    const file = input.files[0];

    Tesseract.recognize(file,'ara',{logger:m=>console.log(m)})
    .then(({data:{text}})=>{
        const numbers = text.match(/\d+/g);
        if(!numbers || numbers.length<1) { alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… ÙƒØ§ÙÙŠØ©."); return; }

        const fields = ['awal','q1','mid','q3','akhir'];
        for(let i=0;i<numbers.length && i<fields.length;i++){
            if(document.getElementById(fields[i]).value===''){
                document.getElementById(fields[i]).value = numbers[i];
            }
        }
        calculateTrend();
    })
    .catch(err=>{ console.error(err); alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙˆØ±Ø©."); });
}
</script>

</body>
</html>
